# ESTIMATORS
There are two primary types of estimators used in this sytem: one accumulates a lot of data and uses it to calibrate the magnetometer, and the other is an MEKF that recursively estimates the attitude and gyroscope bias. The MEKF can also be used to calibrate the photodiodes by passing in a flag. 

## Magnetometer Calibration
The purpose of the magnetometer calibration is to account for imperfections in the magnetometer that affect the measured magnetic field vector. These error sources include constant biases, scale factors, and axes that are not perfectly orthogonal.

For now, time-varying errors caused by current-induced magnetic fields are not included, as any equipment that requires a strong current will not be used during this calibration phase. 

(*Attitude-Independent Magnetometer Calibration
with Time-Varying Bias*, Springmann 2012)

## MEKF + Photodiode Calibration 
A unit-quaternion-based MEKF is used to estimate the attitude and gyroscope bias over time using measured sun and magnetic field vectors.

The purpose of the photodiode calibration is to account for error during installation of the photodiodes; it is assumed that the surface normal of each photodiode is roughly correct, but not perfect. Additionally, the current generated by each photodiode varies and the scale factor needs to be estimated. 

The estimator extends a standard MEKF to estimate these values as well, and does so on-board in an iterative manner. Note that this method is independent of the number of photodiodes that need to be calibrated.

(*On-Orbit Calibration of Photodiodes for Attitude Determination*, Springmann)
([AA236b Class Notes, Dr. Manchester](https://github.com/aa236b-winter-2019/software-simulation/blob/master/References/ADCS%20Lecture%20Notes/Lecture%2012%20-%20MEKF.pdf))